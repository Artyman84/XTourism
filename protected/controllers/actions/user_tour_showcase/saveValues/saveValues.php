<?php/** * Created by PhpStorm. * User: Arty * Date: 20.09.2017 * Time: 19:06 */class saveValues extends CAction {    /**     * User ID     * @var integer     */    public $user_id;    /**     * Redirect     * @var array     */    public $redirect;    /**     * Redirect     * @var array     */    public $data;    /**     * Run Action     */    public function run(){        $user_showcase = ArUserTourShowcase::model()->findByAttributes(['user_id' => $this->user_id]);        $settings = $user_showcase->showcaseSettings();        $user_showcase->dc_dir_id = $this->data['departure_city_id'];        $values = [            'country' => empty($this->data['country_id']) ? 0 : $this->data['country_id'],            'resort' => empty($this->data['resort_id']) ? 0 : $this->data['resort_id'],            'category' => empty($this->data['hotel_category_id']) ? 0 : $this->data['hotel_category_id']        ];        $message = $this->controller->flashMessage('danger', 'При сохранении возникли проблемы. Пожалуйтса, попробуйте еще раз.', true);        if( $settings->validate($values) ) {            $user_showcase->settings = $values;            if ($user_showcase->save()) {                $message = $this->controller->flashMessage('success', '<strong>Настройки витрины</strong> были успешно изменены.', true);            }        }        Yii::app()->user->setFlash('showcase_values', $message);        $this->controller->redirect($this->redirect);    }}